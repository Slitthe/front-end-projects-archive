// see non-minified version at --> https://github.com/Slitthe/dota2-items-filter/blob/master/js/main.js
// Minified using --> https://javascript-minifier.com/
function filterElements(){filterData.currentItems=filterData.initialItems();for(var t=0;t<criterias.length;t++)filterData.currentItems=filterData.currentItems.filter(function(e){return e.categories.indexOf(criterias[t])>=0})}function checkOtherFilters(t){attrNames.forEach(function(t){var e=filterData.currentItems.filter(function(e){return e.categories.indexOf(t)>=0}).length;0===e?inputElements[t].setAttribute("disabled",!0):inputElements[t].removeAttribute("disabled")})}function displayItems(t,e){var i,s="";for(i=0;i<e.length;i++)s+='<li class="item" data-name="'+e[i].itemName+'">',s+='<div class="img_container"><img src="img/items/'+e[i].itemName+'.png"></div>',s+='<h3 class="item_name font_small">'+e[i].displayInfo.displayName+"</h3>",s+='<div class="item_gold">'+e[i].displayInfo.gold+"</div>",s+='<div class="faux_button"></div></li>';for(i=0;elementsPerRow>=i;i++)s+='<div class="filler_item"></div>';s+='<div id="item_tooltip" class="item_tooltip hide">Item Display</div>',t.innerHTML=s,itemSearch("item",searchInput)}function addEvents(){var t,e=document.getElementById("item_tooltip"),i=(document.getElementsByClassName("item"),document.getElementsByClassName("faux_button"));for(t=0;t<i.length;t++)i[t].addEventListener("mouseover",function(){wholePage||tooltipDisplay(this.parentElement,e,filterData.currentItems)});for(t=0;t<i.length;t++)i[t].addEventListener("click",function(){tooltipDisplay(this.parentElement,e,filterData.currentItems),tooltipShow()}),i[t].addEventListener("mouseout",function(){wholePage||e.classList.add("hide")});isTap=!1,e.addEventListener("touchstart",function(t){wholePage||(isTap=!0)}),e.addEventListener("touchmove",function(t){wholePage||(isTap=!1)}),e.addEventListener("touchend",function(t){wholePage||isTap&&this.classList.add("hide")})}function itemInfoDisplay(t,e){var i,s,a=["itemIcon","displayName","gold","skills","info","attributes","lore"],n="";for(s=0;s<e.length;s++)if(e[s].itemName===t){i=e[s].displayInfo;break}var o={itemIcon:function(t){var e='<div class="tooltip_icon" style="background-image:';return e+="url(img/items/"+t+'.png)">',e+="</div>"},skills:function(t,e){var i='<div class="tooltip_skills">';return t.forEach(function(t){if(i+='<div class="skill">',i+='<div class="skills_title clearfix"><h4 class="skills_title_text">'+t.title+"</h4>",e){var s=["cooldown_time","mana_cost"];e.forEach(function(t,e){i+='<div class="'+s[e]+'">'+t+"</div>"}),e=!1}i+="</div>",t.text.forEach(function(t){t=t.replace(/(\d+%*)/g,'<span class="skills_line_value">$1</span>');var e="";"**WARN**"===t.substring(0,8)&&(e="warning_message",t=t.substring(8)),i+='<p class="skills_line '+e+'">'+t+"</p>"}),i+="</div>"}),i+="</div>"},attributes:function(t){var e='<ul class="tooltip_item_attrs">';return t.forEach(function(t){e+='<li class="attribute">',e+='<span class="attribute_value">'+t[0]+" </span>",e+='<span class="attribute_name">'+t[1]+"</span>",e+="</li>"}),e+="</ul>"},info:function(t){var e='<div class="tooltip_info_messages">';return t.forEach(function(t){e+='<p class="tooltip_info_message">'+t+"</p>"}),e+="</div>"},displayName:function(t){return'<h3 class="tooltip_title">'+t+"</h3>"},lore:function(t){return'<p class="tooltip_item_lore font_small">'+t+"</p>"},gold:function(t){return'<div class="tooltip_gold">'+t+"</div>"}};for(s=0;s<a.length;s++)i.hasOwnProperty(a[s])&&(n+="skills"===a[s]&&i.hasOwnProperty("cdCost")?o[a[s]](i[a[s]],i.cdCost):o[a[s]](i[a[s]]));return n}function tooltipDisplay(t,e,i){var s,a,n,o,l,r;e.innerHTML=itemInfoDisplay(t.getAttribute("data-name"),i),n=window.scrollY+window.innerHeight,l=document.body.offsetHeight,e.classList.remove("hide"),s=t.offsetLeft-e.offsetWidth,a=document.body.offsetWidth-(t.offsetWidth+t.offsetLeft+e.offsetWidth),a>s?e.style.left=t.offsetLeft+t.offsetWidth+2+"px":e.style.left=t.offsetLeft-e.offsetWidth-2+"px",e.style.top=t.offsetTop+"px",o=e.offsetTop+e.offsetHeight,o>n?(r=n-o-15,e.style.top=parseInt(e.style.getPropertyValue("top"))+r+"px"):o>l&&(r=l-o-15,e.style.top=parseInt(e.style.getPropertyValue("top"))+r+"px")}function itemSearch(t,e){var i,s,a,n=document.getElementsByClassName(t),o=[];if(n.forEach=Array.prototype.forEach,e.value.length>=1){for(n[0].parentElement.classList.add("active_search"),i=e.value.split(/\u0020+/gi),s=0;s<filterData.currentItems.length;s++)for(a=0;a<i.length&&-1!==filterData.currentItems[s].displayInfo.displayName.indexOf(i[a].toLowerCase());a++)a===i.length-1&&o.push(filterData.currentItems[s]);n.forEach(function(t){t.classList.remove("match")}),n.forEach(function(t){o.forEach(function(e){t.getAttribute("data-name")===e.itemName&&t.classList.add("match")})})}else n[0].parentElement.classList.remove("active_search"),n.forEach(function(t){t.classList.remove("match")})}function tooltipHide(t){var e=document.getElementById("item_tooltip");e.classList.remove("tooltip_whole_page"),e.classList.add("hide"),tooltipHideBtn.classList.add("hide"),wholePage=!1,hideBody.classList.add("hide"),documentRoot.classList.remove("whole_page_tooltip")}function tooltipShow(){windowLocation=window.scrollY;var t=document.getElementById("item_tooltip");t.style.left="",t.style.top="",t.classList.remove("hide"),wholePage=!0,t.classList.add("tooltip_whole_page"),tooltipHideBtn.classList.remove("hide"),hideBody.classList.remove("hide"),documentRoot.classList.add("whole_page_tooltip")}function init(){attrNames.forEach(function(t){inputElements[t]=document.querySelector("input[value='"+t+"']")}),searchInput=document.getElementById("search_input"),searchResetBtn=document.getElementById("search_reset_btn"),itemsOutput=document.querySelector(".items_output"),checkboxes=document.querySelectorAll(".filters input[type='checkbox']"),resetBtn=document.querySelector(".filters_reset_btn"),tooltipHideBtn=document.getElementById("tooltip_hide"),mainWrapper=document.querySelector("main"),documentRoot=document.querySelector("html"),hideBody=document.getElementById("hide_body");for(var t=0;t<checkboxes.length;t++)checkboxes[t].addEventListener("change",function(){if(this.checked)criterias.push(this.getAttribute("value"));else for(var t=0;t<criterias.length;t++)criterias[t]===this.getAttribute("value")&&criterias.splice(t,1);filterElements(),checkOtherFilters(filterData.currentItems),displayItems(itemsOutput,filterData.currentItems),addEvents()});tooltipHideBtn.addEventListener("click",function(){if("fixed"===window.getComputedStyle(documentRoot).position)var t=!0;tooltipHide(),t&&window.scrollTo(0,windowLocation)}),hideBody.addEventListener("click",function(){tooltipHide()}),resetBtn.addEventListener("click",function(){var t=document.getElementById("search_input");attrNames.forEach(function(t){inputElements[t].checked=!1}),criterias=[],filterElements(),checkOtherFilters(),displayItems(itemsOutput,filterData.currentItems),addEvents(),t.value="",itemSearch("item",t)}),searchInput.addEventListener("input",function(t){this.value.length>=1&&this.value[this.value.length-1].search(/[^a-zA-Z\u0020']+/gi)>-1&&(this.value=this.value.substring(0,this.value.length-1)),itemSearch("item",this)}),document.addEventListener("keydown",function(t){(t.which>=65&&t.which<=90||t.which>=97&&t.which<=122)&&searchInput.focus(),27===t.which&&(searchInput.value="",itemSearch("item",searchInput))}),searchResetBtn.addEventListener("click",function(){searchInput.value="",itemSearch("item",searchInput)}),filterElements(),displayItems(itemsOutput,filterData.currentItems),addEvents()}var attrNames=["str","int","agi","all_atr","hp","hp_reg","hp_rest","mana","mana_reg","mana_rest","armor","mg_resist","evs_acc","phy_mg_blk_imm","reflect","attk_speed","dmg","crit","life_steal","mg_dmg","aoe_dmg","summs_ills","inv_vision","gold_exp","mv_speed","mobi","disable","cdr","range_inc","activable","toggable","start_item","consumable","home","side","secret","shareable"],criterias=[],elementsPerRow=23,wholePage=!1,itemsOutput,checkboxes,resetBtn,isTap,tooltipHideBtn,mainWrapper,searchInput,searchResetBtn,hideBody,windowLocation,inputElements={},documentRoot,filterData={initialItems:function(){return JSON.parse(items)}};items=JSON.stringify(items),filterData.currentItems=filterData.initialItems(),init();
